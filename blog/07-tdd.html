<!DOCTYPE html><html lang="ko"><head><meta name="viewport" content="width=device-width, initial-scale=1"/><meta charSet="utf-8"/><meta name="Description" content="Personal Blog"/><title>Henry&#x27;s log</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/b41a285680658cab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b41a285680658cab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-660c25f5326cfe89.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-9b95277ed2619e28.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d1fa4175fc69bdc0.js" defer=""></script><script src="/_next/static/chunks/184-8452e3c4cd85067e.js" defer=""></script><script src="/_next/static/chunks/597-891f0d8faba9981d.js" defer=""></script><script src="/_next/static/chunks/pages/blog/07-tdd-9360533451753adf.js" defer=""></script><script src="/_next/static/HPZ7aYl1DCoRILVvtuLIo/_buildManifest.js" defer=""></script><script src="/_next/static/HPZ7aYl1DCoRILVvtuLIo/_ssgManifest.js" defer=""></script><style id="__jsx-2777855943">.hide.jsx-2777855943{display:none;}h1.jsx-2777855943{font-size:1.5rem;font-weight:700;color:var(--color-header);font-family:"Recoleta-bold";}.great-title.jsx-2777855943{margin-top:2.5rem;font-size:3.125rem;text-align:center;color:var(--color-header);}.details.jsx-2777855943 span.jsx-2777855943{color:#bdbdbd;margin-right:1rem;}.details.jsx-2777855943{font-weight:300;margin-bottom:2px;font-size:11pt;line-height:22pt;-webkit-letter-spacing:0.8px;-moz-letter-spacing:0.8px;-ms-letter-spacing:0.8px;letter-spacing:0.8px;font-family:"NotoSansKR-Thin",MalgunGothic;}.date.jsx-2777855943{font-size:15px;}</style></head><body><script>(function() {
	function setInitialColorMode() {
  function getInitialColorMode() {
    const persistedColorPreference = window.localStorage.getItem("theme");
    const hasPersistedPreference = typeof persistedColorPreference === "string";
    /**
     * If the user has explicitly chosen light or dark,
     * use it. Otherwise, this value will be null.
     */

    if (hasPersistedPreference) {
      return persistedColorPreference;
    } // If there is no saved preference, use a media query


    const mql = window.matchMedia("(prefers-color-scheme: dark)");
    const hasMediaQueryPreference = typeof mql.matches === "boolean";

    if (hasMediaQueryPreference) {
      return mql.matches ? "dark" : "light";
    } // default to 'light'.


    return "light";
  }

  const colorMode = getInitialColorMode();
  const root = document.documentElement;
  root.style.setProperty("--initial-color-mode", colorMode); // add HTML attribute if dark mode

  if (colorMode === "dark") document.documentElement.setAttribute("data-theme", "dark");
}
	setInitialColorMode();
})()
</script><div id="__next" data-reactroot=""><div class="container"><main><div style="display:flex;align-items:center;justify-content:center;margin:0 4rem 0 4rem;flex-shrink:0"><div class="shake-it" style="flex:9"><a href="/"><h1 style="font-size:1.125rem">Henry</h1></a></div><div style="flex-shrink:0;width:15px"></div><a href="/blog"><h2 style="font-size:0.825rem;padding-right:5px">Blog</h2></a><div style="flex-shrink:0;width:15px"></div><a href="https://lee-note.notion.site/82a3ac3053a9457b9f1a4e1b3d7baedc?v=2acb0e3dd5c64d4d8582ee28f193acd7" target="_blank"><h2 style="font-size:0.825rem">Read</h2></a><div style="flex-shrink:0;width:15px"></div><a href="/about"><h2 style="font-size:0.825rem">About</h2></a><div style="flex-shrink:0;width:15px"></div><label style="padding-bottom:2.8px"><input type="checkbox"/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="1em" height="1em" style="position:relative;font-size:25px;top:3.465px"><path fill="#FF9800" d="M11 11h26v26H11z"></path><path fill="#FF9800" d="M6 24 24 6l18 18-18 18z"></path><path fill="#FFEB3B" d="M13 24c0 6.077 4.923 11 11 11 6.076 0 11-4.923 11-11s-4.924-11-11-11c-6.077 0-11 4.923-11 11"></path></svg></label></div><div class="content"><div><h1 class="jsx-2777855943 great-title">TDD</h1><div class="jsx-2777855943 details"><span class="jsx-2777855943 hide">May 4, 2021</span><span class="jsx-2777855943 hide">4 min read</span></div><article><div style="margin-top:4rem;font-family:Poppins, NotoSansKR-Thin, MalgunGothic;font-size:11pt;line-height:22pt;letter-spacing:.8px"><h1>TDD</h1><hr/><h3 style="font-family:SeoulNamsanL"><p>단위 테스트할 수 있는 코드를 작성하라</p></h3><p>단위 테스트를 할 수 있는 코드를 만들려면 프로그램을 단위별로 나누어 개발하라.</p><p>단위란 작은 인터페이스 와 단일 책임을 가진 모듈을 말한다. 다른 단위의 서비스를 사용해야 한다면 의존성 주입이라는 SOLID 한 친구에게 부탁하라.
받는 쪽 생성자 함수를 통해 서비스를 주고자 한다면, 단위 테스트 시 모형을 사용해 테스트할 대상코드를 하나의 단위로 좁힌다.</p><hr/><p><strong>테스트 결과 자체를 기능명세로 보고 될 수 있도록 구체적으로 기술한다.</strong></p><br/><p><strong>기본적 TDD의 절차</strong></p><ul>
<li>
<p>실패하는 테스트를 작성한다. 본인이 무엇을 테스트하려고 하는지 확실해진다.</p>
<ul>
<li>코딩 전 테스트를 먼저 작성한다.</li>
<li>에러조건을 먼저 테스트한다.</li>
<li>복잡한것 보다 간단한것을 먼저 테스트한다.</li>
<li>구체적으로 작성한다.</li>
<li>테스트 마다 한가지만 확인한다.</li>
</ul>
</li>
<li>
<p>테스트가 성공할만큼 코딩한다.</p>
</li>
<li>
<p>리팩토링 한다.</p>
<ul>
<li>DRY 하게 유지한다.</li>
</ul>
</li>
<li>
<p>실패하는 테스트에서는 해당 기능을 어떻게 구성할지 또, 어떤 것이 필요한지등의 명세를 작성한다.</p>
</li>
</ul><br/><h1>BDD</h1><hr/><ul>
<li>테스트 코드는 곧 명세가 된다.</li>
<li>BDD(행위 주도 개발) ~는 이러해야 한다. 동작에 대해 그린다.</li>
<li>사용자 측면에서의 테스트 한다.<!-- -->
<ul>
<li>사용자에게 예상하는대로의 기능을 제공하는지를 테스트 한다.</li>
<li>사용자는 해당 기능이 어떻게 실행되는지 신경쓰지 않는다. 그저 자신이 기대하는대로 작동하는 지를 고려한다.</li>
</ul>
</li>
</ul><br/><h1>RTL</h1><p>RTL에서는 컴포넌트 인스턴스가 아닌 DOM 노드에 대한 테스트를 해야 합니다.</p><div style="font-family:Poppins, &quot;SeoulNamsanL&quot;;border-radius:4px;line-height:1.9rem;max-width:100%;font-size:0.965rem;font-weight:100;position:relative;padding:2rem 1rem"><p>The main utilities it provides involve querying the DOM for nodes in a way that&#x27;s similar to how the user finds elements on the page. In this way, the library helps ensure your tests give you confidence that your application will work when a real user uses it.
It should be generally useful for testing the application components in the way the user would use it.</p></div><ul>
<li><code>getBy*</code> : 동기적이며, 해당 요소가 DOM 안에 있는지 확인하고, 존재하지 않으면 에러를 일으킨다.</li>
<li><code>findBy*</code> : 비동기적이며, 특정 시간 이후 찾지못하면 에러를 발생시킨다.</li>
<li><code>queryBy*</code> : 동기적이며, 요소를 찾지 못하더라도 에러를 발생시키지 않고 null을 리턴한다.</li>
</ul><br/><div class="blog-post"><pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render<span class="token punctuation">,</span> screen <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&quot;@testing-library/react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports">userEvent</span> <span class="token keyword module">from</span> <span class="token string">&quot;@testing-library/user-event&quot;</span><span class="token punctuation">;</span>

<span class="token comment">/*
  RTL 에서는 사용자의 관점, 실제 어떻게 동작하는지에 대해 테스팅 한다.
  상태가 어떻게 관리되고, prop이 어떻게 넘어가는지 등은 RTL의 목표가 아니다.
*/</span>

<span class="token comment">// Arrange → Act → Assert</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Header /&gt;&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;should link points to the correct page&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Act</span>
    <span class="token function">render</span><span class="token punctuation">(</span>
      <span class="token operator">&lt;</span><span class="token maybe-class-name">MemoryRouter</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">MemoryRouter</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Assert</span>
    <span class="token keyword">const</span> link <span class="token operator">=</span> screen<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">&quot;link&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">pageA</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userEvent<span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// debug</span>
    screen<span class="token punctuation">.</span><span class="token method function property-access">debug</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// prettier-ignore</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">&quot;heading&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">pageA</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeInTheDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>컴포넌트가 다른 컴포넌트를 인스턴스로 갖는다면 어떻게 테스트 해야할까</strong></p><p>먼저, RTL 에서는 Parent 컴포넌트가 Child 컴포넌트를 어떻게 렌더링 하는지는 고려 요소가 아니다.</p><p>만약, 헤더 컴포넌트가 있고, 헤더 컴포넌트를 포함한 App 컴포넌트가 있다고 할때, 헤더 컴포넌트만 따로 분리해서 테스트를 작성하는 것이 아닌 App 컴포넌트를 사용하여
어플리케이션 컨텍스트 안에서 테스트 하는 방법이 있다.</p><hr/><p>그래도 하겠다면.. 그럼 어떻게 테스팅 해야 하는가 ?</p><ol>
<li>
<p><code>data-testid</code>를 포함한 태그를 추가한다. 해당 DOM에 접근해서 테스팅 하는걸 목표로 한다.</p>
</li>
<li>
<p><code>Using mocking of the child component</code></p>
</li>
</ol><div class="blog-post"></div><pre class="language-ts"><code class="language-ts"><span class="token comment">/*
  &lt;Forms&gt;
    &lt;Input /&gt;
  &lt;/Forms&gt;
*/</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render<span class="token punctuation">,</span> screen <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&quot;@testing-library/react&quot;</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Forms /&gt;&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;should render Input component&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span><span class="token method function property-access">getByLabelText</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">input</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeInTheDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><h1>RTL 에서 피해야하는 테스팅</h1><ol>
<li>컴포넌트의 내부 상태</li>
<li>컴포넌트의 내부 메서드</li>
<li>컴포넌트의 메서드 라이프사이클</li>
<li>자식 컴포넌트</li>
</ol><br/><h1>MOCKING</h1><hr/><p>프론트엔드 에서는 UI 컴포넌트가 페이지를 렌더링하기 전에 API 요청을 통해 데이터를
가져오는 일이 흔하다. 위의 과정을 테스트 하려면 일반적으로 실제 API 요청을 하는 과정을
테스팅 하게 될텐데, 이는 좋은 방법이 아니다. 테스트 시간이 많이 소요될 수 있고, 같은
요청에 다른 데이터가 올수도있는 등의 예측하기 어려운 문제가 일어날 수 있기 때문이다.</p><hr/><p>그럼 어떻게 해야 할까 ?</p><p><code>Mock API</code>를 사용해서 fake data를 리턴하여, UI 컴포넌트의 요소들과 비교, 매칭한다.</p></div>
<br/></article></div></div></main><footer style="font-size:0.625rem;font-weight:200;flex-shrink:0;margin:4.125rem">2022 © Henry</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blog/07-tdd","query":{},"buildId":"HPZ7aYl1DCoRILVvtuLIo","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>