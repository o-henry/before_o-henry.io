<!DOCTYPE html><html lang="ko"><head><meta name="viewport" content="width=device-width, initial-scale=1"/><meta charSet="utf-8"/><meta name="Description" content="Personal Blog"/><title>Henry&#x27;s log</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/ca321dd4381b725339d6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ca321dd4381b725339d6.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.e3de07479da4f2477dea.js" as="script"/><link rel="preload" href="/_next/static/chunks/d70fd1b25595f0b45425438df4c8a48f991b761f.e7f675c8e0e3e55d570c.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-0c745f6f0b8429b3d770.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-6f3f6c4298f3183be646.js" as="script"/><link rel="preload" href="/_next/static/chunks/37a53a466e8eb68de829d4e586a930f1e32d6d5d.837dddf646bee485fe57.js" as="script"/><link rel="preload" href="/_next/static/chunks/a0030956262e019ab23a349e93f1ea28a12e43a9.22b82b2039b854f1ba07.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/03-redux-f6d079b087dc95ee48fb.js" as="script"/><style id="__jsx-2632742570">.hide.jsx-2632742570{display:none;}h1.jsx-2632742570{font-size:1.5rem;font-weight:700;color:var(--color-header);font-family:"Poppins";}.great-title.jsx-2632742570{font-size:3.125rem;text-align:center;color:var(--color-header);}.details.jsx-2632742570 span.jsx-2632742570{color:#bdbdbd;margin-right:1rem;}.details.jsx-2632742570{font-weight:300;margin-bottom:2px;font-size:11pt;line-height:22pt;-webkit-letter-spacing:0.8px;-moz-letter-spacing:0.8px;-ms-letter-spacing:0.8px;letter-spacing:0.8px;font-family:"NotoSansKR-Thin",MalgunGothic;}.date.jsx-2632742570{font-size:15px;}</style></head><body><script>(function() {
	function setInitialColorMode() {
  function getInitialColorMode() {
    const persistedColorPreference = window.localStorage.getItem("theme");
    const hasPersistedPreference = typeof persistedColorPreference === "string";
    /**
     * If the user has explicitly chosen light or dark,
     * use it. Otherwise, this value will be null.
     */

    if (hasPersistedPreference) {
      return persistedColorPreference;
    } // If there is no saved preference, use a media query


    const mql = window.matchMedia("(prefers-color-scheme: dark)");
    const hasMediaQueryPreference = typeof mql.matches === "boolean";

    if (hasMediaQueryPreference) {
      return mql.matches ? "dark" : "light";
    } // default to 'light'.


    return "light";
  }

  const colorMode = getInitialColorMode();
  const root = document.documentElement;
  root.style.setProperty("--initial-color-mode", colorMode); // add HTML attribute if dark mode

  if (colorMode === "dark") document.documentElement.setAttribute("data-theme", "dark");
}
	setInitialColorMode();
})()
</script><div id="__next"><main><div style="display:flex;align-items:center;justify-content:center"><div style="flex:9"><a href="/"><h1 style="font-size:1.125rem">Henry</h1></a></div><div style="flex-shrink:0;width:15px"></div><a href="/blog"><h2 style="font-size:0.825rem">Blog</h2></a><div style="flex-shrink:0;width:15px"></div><a href="/about"><h2 style="font-size:0.825rem">About</h2></a><div style="flex-shrink:0;width:15px"></div><label><input type="checkbox"/><svg width="1em" height="1em" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg" style="position:relative;font-size:25px;top:3.465px"><path d="M11.75 35.417l-1.48 1.479a2.083 2.083 0 000 2.937 2.084 2.084 0 002.938 0l1.48-1.479a2.084 2.084 0 00-2.938-2.937zM10.417 25a2.083 2.083 0 00-2.084-2.083H6.25a2.083 2.083 0 000 4.166h2.083A2.083 2.083 0 0010.417 25zM25 10.417a2.083 2.083 0 002.083-2.084V6.25a2.083 2.083 0 00-4.166 0v2.083A2.083 2.083 0 0025 10.417zm-13.25 4.27a2.084 2.084 0 002.938 0 2.084 2.084 0 000-2.937l-1.48-1.48a2.083 2.083 0 00-2.937 2.938l1.48 1.48zm25 .605a2.084 2.084 0 001.458-.604l1.48-1.48a2.082 2.082 0 10-2.938-2.937l-1.333 1.479a2.083 2.083 0 000 2.938c.367.365.857.58 1.375.604h-.042zm7 7.625h-2.083a2.083 2.083 0 000 4.166h2.083a2.083 2.083 0 000-4.166zM25 39.583a2.083 2.083 0 00-2.083 2.084v2.083a2.083 2.083 0 004.166 0v-2.083A2.083 2.083 0 0025 39.583zm13.25-4.166a2.084 2.084 0 00-2.833 2.833l1.479 1.48a2.084 2.084 0 002.937 0 2.083 2.083 0 000-2.938l-1.583-1.375zM25 13.542A11.458 11.458 0 1036.458 25 11.48 11.48 0 0025 13.542zm0 18.75a7.292 7.292 0 110-14.585 7.292 7.292 0 010 14.585z" fill="#000"></path></svg></label></div><div class="content"><h1 class="jsx-2632742570 great-title">Redux</h1><div class="jsx-2632742570 details"><span class="jsx-2632742570 hide">Nov 15, 2020</span><span class="jsx-2632742570 hide">7 min read</span></div><article><div style="margin-top:4rem;font-family:Poppins, NotoSansKR-Thin, MalgunGothic;font-size:11pt;line-height:22pt;letter-spacing:.8px"><h1>Redux</h1><hr/><p>리덕스는 <code>actions</code> 이벤트를 사용하여 어플리케이션의 상태를 관리하고 업데이트 하는 패턴 및 라이브러리 입니다.
리덕스는 상태관리를 컴포넌트 밖에서 합니다. 앱의 상태 전부는 하나의 <strong>store</strong> 안에
있는 객체 트리에 저장됩니다. <strong>상태 트리를 변경</strong> 하는 방법은 <strong>action</strong>을 보내는 것 뿐입니다.
액션이 상태트리를 어떻게 변경할지 명시하기 위해 <strong>reducers</strong>를 작성해야 합니다.</p><hr/><p><strong>리덕스를 언제 사용해야 할까요</strong></p><blockquote><p>I would like to amend this: don&#x27;t use Redux until you have problems with vanilla React. - Dan Abramov</p></blockquote><ul><li>앱의 여러 위치에 필요한 많은 양의 상태를 갖고 있을 때</li><li>앱의 상태가 자주 업데이트 될때</li><li>상태 업데이트 로직이 복잡할때</li><li>많은 사람들이 작업하고, 중간 또는 큰 사이즈의 코드 베이스를 가질때</li></ul><hr/><div class="blog-post"><div class="language-ts"><pre class="language-ts"><span class="token comment">// one-way data flow</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Counter</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// State: the source of truth that drives our app;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>counter<span class="token punctuation">,</span> setCounter<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Action: the events that occur in the app based on user input,</span>
  <span class="token comment">// and trigger updates in the state</span>
  <span class="token keyword">const</span> <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setCounter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prevCounter<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> prevCounter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// View: a declarative description of the UI based on the current state</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token maybe-class-name">Value</span><span class="token operator">:</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span> <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token maybe-class-name">Increment</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div></div><div class="think">컴포넌트를 만들때, UI를 만들고 해당 UI 에서는 button 이나 Input등의 이벤트를 발생시키고, 이를 통해 상태를 변경 할텐데, Redux로 해당 UI에서 상태가 변경되었다를 알리기 위해서 Action을 Dispatch를 합니다. (말 그대로 일어난 이벤트를 보낸다) 그러면 store에 있는 리듀서가 해당 액션을 처리하여 새로운 상태로 값을 반환할텐데, 이때 리듀서는 어떤 액션이 들어왔는지 구분하기 위해서 type이라는 속성을 갖게 됩니다.</div><h1>Actions</h1><p>action은 객체 형태로 애플리케이션에서 스토어로 보내는 데이터 묶음 입니다. <code>store.dispatch()</code>를 통해서 보냅니다. 반드시 <strong>type</strong> 속성을 가져야 합니다.
type 속성값은 리듀서에 액션 객체를 구분할 때도 사용되기 때문에 상수 변수로 만드는것이 좋습니다. 액션은 어플리케이션에서 발생한 작업을 설명하는 이벤트라고 생각하면 됩니다.
<strong>payload</strong> 필드에는 추가적인 정보가 담겨있습니다.</p><div class="think">React 자체의 상태관리를 할때에는 해당 함수 안에서 상태를 관리하는데 반해 redux는 global store를 통해 모든 앱에서의 상태를 공유 하게 됩니다. 이는 곧, 해당 상태가 바뀌었다는 정보를 global store에 전달해줘야 한다는 얘기이며, 이를 위해 action을 dispatch 합니다.</div><hr/><h1>Reducers</h1><p>reducer는 이전 상태값과, 액션 객체를 입력으로 받아 새로운 상태값을 만드는 <strong>순수함수</strong>
입니다. <code>(state, action) =&gt; newState</code> 리듀서를 액션 타입을 기준으로 이벤트를 처리 하는 이벤트 리스너라고 생각할 수 있습니다.
사이드 이펙트를 일으켜서는 안되며, state를 직접적으로 변경해서는 안됩니다. 불변성을 유지하며 상태를 업데이트 해야 합니다.</p><div class="blog-post"><div class="language-js"><pre class="language-js"><span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">counterReducer</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> initialState<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Check to see if the reducer cares about this action</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">===</span> <span class="token string">&quot;counter/increment&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If so, make a copy of `state`</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
      <span class="token spread operator">...</span>state<span class="token punctuation">,</span>
      <span class="token comment">// and update the copy with the new value</span>
      value<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// otherwise return the existing state unchanged</span>
  <span class="token keyword control-flow">return</span> state<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div></div><br/><h1>Middleware</h1><p>미들웨어는 리듀서가 액션을 처리하기전에 실행되는 함수 입니다. 디버깅 목적으로 상탯값
변경시 로그를 출력하거나, API 호출 등의 목적으로 활용 가능합니다.</p><br/><h1>Selector</h1><p><code>useSelector</code> 훅을 활용하면 store에 있는 데이터를 읽어올 수 있습니다.
selector 함수는 모든 state object를 받고, 값으로 반환해야 합니다.
selector 함수는 리덕스 스토어가 업데이트 되면 언제든지 재실행 됩니다. 그리고 만약 데이터가 변경된 경우 컴포넌트는 다시 렌더링 됩니다.
즉, 리렌더링이 언제든지 일어날 수 있기 때문에, 컴포넌트들은 항상 스토어로부터 필요한 최소한의 데이터를 select 하여 실제 필요한 경우에만 렌더링 되도록 해야 합니다.
이를 방지하기 위해 RTK 는 <code>createSelector</code> 함수를 제공합니다. <code>reselet</code> 라이브러리의 기능으로 메모이제이션을 지원하여, 무분별한 렌더링을 방지 합니다.</p><br/><h1>Think</h1><hr/><div><pre>★ 사용하는 데이터가 하나다. ⇢ 리듀서를 하나만 사용한다.
★ 사용되는 데이터의 양이 많아진다. ⇢ 데이터를 기능별로 폴더를 만들어 하위에서 관리/구조화 한다.
★ 분리한 리듀서를 통합한다 ⇢ combineReducder

페이스북에서 &#x27;타임라인&#x27; 과 &#x27;친구목록&#x27;을 구현한다고 하자.
★ 타임라인 에서는 사용자에게 보여줄 여러 개의 게시물을 관리해야 한다.
└── 각 게시물 데이터를 배열로 관리한다.
└── 게시물을 추가 / 삭제 할 수 있어야 한다.
└── 각 게시물의 좋아요 숫자는 변하는 값이므로 게시물 데이터를 수정할 수 있어야 한다.
└── 무한 스크롤 기능이 필요 하므로 로딩된 데이터 끝에 도달하면 자동으로 다음 데이터를 서버로 요청해야 한다.

★ 친구 목록
└── 친구목록 데이터를 배열로 관리한다.
└── 친구를 추가 / 삭제 할 수 있어야 한다.
└── 친구가 수정한 프로필 정보를 반영하기 위해 친구 데이터를 수정할 수 있어야 한다.

★ 덕스 패턴
└── 연관된 액션 타입, 액션 생성자 함수, 리듀서를 하나의 파일로 작성한다.
└── 리듀서 함수는 export default 키워드로 내보낸다.
└── 액션 생성자 함수는 export 키워드로 내보낸다.
└── 액션 타입은 접두사와 액션 이름을 조합해서 만든다.

★ (친구 목록) 액션 과 리듀서 코드를 먼저 작성한다.
◦ 데이터 타입은 어떻게 되어 있는가 ⇢ 배열로 관리한다.
◦ 어떤 액션 타입이 필요한가 ⇢ 친구를 추가 / 삭제 할 수 있어야 하고, 데이터를 수정할 수 있어야 한다.
◦ 리듀서 에서 상탯값을 수정한다. ⇢ ADD, REMOVE, EDIT 에 해당하는 로직을 구현한다.

★ (타임 라인) 액션 과 리듀서 코드를 작성한다.
◦ 데이터 타입은 어떻게 되어 있는가 ⇢ 배열로 관리한다.
◦ 어떤 액션 타입이 필요한가 ⇢ 게시물을 추가 / 삭제 및 게시물을 수정 또 페이지 번호 증가.

★ 리듀서의 공통 부분 분리하기
◦ 초기 상태값 빈 배열 정의
◦ 액션 타입과 액션 생성자 함수
◦ 데이터 추가/삭제/수정 리듀서 코드
└── 공통부분에 해당하는 부분을 모듈화 한다.
</pre></div><br/></div></article></div></main><footer style="font-size:0.625rem;font-weight:200;margin-top:2.625rem;margin-bottom:2.5rem">2021 © Henry</footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blog/03-redux","query":{},"buildId":"xL55VW0AnZSK2iA9VX3iS","nextExport":true,"autoExport":true,"isFallback":false}</script><script nomodule="" src="/_next/static/chunks/polyfills-0a3f5575d2f25aee06a0.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.e3de07479da4f2477dea.js" async=""></script><script src="/_next/static/chunks/d70fd1b25595f0b45425438df4c8a48f991b761f.e7f675c8e0e3e55d570c.js" async=""></script><script src="/_next/static/chunks/main-0c745f6f0b8429b3d770.js" async=""></script><script src="/_next/static/chunks/pages/_app-6f3f6c4298f3183be646.js" async=""></script><script src="/_next/static/chunks/37a53a466e8eb68de829d4e586a930f1e32d6d5d.837dddf646bee485fe57.js" async=""></script><script src="/_next/static/chunks/a0030956262e019ab23a349e93f1ea28a12e43a9.22b82b2039b854f1ba07.js" async=""></script><script src="/_next/static/chunks/pages/blog/03-redux-f6d079b087dc95ee48fb.js" async=""></script><script src="/_next/static/xL55VW0AnZSK2iA9VX3iS/_buildManifest.js" async=""></script><script src="/_next/static/xL55VW0AnZSK2iA9VX3iS/_ssgManifest.js" async=""></script></body></html>